(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{486:function(e,n,a){"use strict";a.r(n);var t=a(10),r=Object(t.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"hyperledger-fabric-s-application-development-practices"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hyperledger-fabric-s-application-development-practices"}},[e._v("#")]),e._v(" Hyperledger Fabric's Application Development Practices")]),e._v(" "),n("p",[e._v("Refer to "),n("a",{attrs:{href:"https://github.com/sanyam-gupta583/balance-transfer-zeeve",target:"_blank",rel:"nofollow noopener"}},[e._v("Sample Project"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Certain practices can help the developer create applications which are one click deployable on Zeeve. They are:-")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("For packaging your product to be automated by Zeeve, you will need to "),n("a",{attrs:{href:"https://docs.docker.com/engine/examples/",target:"_blank",rel:"nofollow noopener"}},[e._v("dockerize"),n("OutboundLink")],1),e._v(" your project's services by creating "),n("code",[e._v("Dockerfiles")]),e._v(" for them.")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("FROM node:8.9.0\n\nWORKDIR /balance-transfer\n\nCOPY . .\nENV PORT=4000\nRUN npm install\nCMD node app\n")])])])]),e._v(" "),n("li",[n("p",[e._v("Make use of "),n("code",[e._v("network-config.yaml")]),e._v(" (connections profiles) and "),n("code",[e._v("org.yaml")]),e._v(" (if required) for all blockchain related configurations. At the time of deployment for a network, Zeeve creates these files and allows the developer to download them along with the other artifacts. You can consider this file to develop your applications. All other application configs should be part of the Docker image itself.")])]),e._v(" "),n("li",[n("p",[e._v("Create a "),n("code",[e._v(".env")]),e._v(" file containing an array of domain prefixes corrosponding to Ingress resource definitions. The syntax should be of the form:\n"),n("code",[e._v('("<domain_prefix_1>:<ingress_resource_name_1>" "<domain_prefix_2>:<ingress_resource_name_2> ...")')])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('EXT_EXPOSED_SERVICES=("balancetranfer:balance-transfer-ingress")\n')])])])]),e._v(" "),n("li",[n("p",[e._v("Create a "),n("code",[e._v("docker-compose-build.yaml")]),e._v(" file for creating images of all services that your application requires. This will help Zeeve create relevant images, push them to the container-registry and later use them.")]),e._v(" "),n("ul",[n("li",[e._v("Each service definition whose container image would be created needs to have an "),n("code",[e._v("image")]),e._v(" keyword, the associated value needs to same as that of image name (Deployment.contianers.spec.containers.image) in k8_application.yaml.template.")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "2.0"\n\nservices:\n  balance-transfer:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: balance-transfer:latest\n    container_name: balance-transfer-default\n    ports:\n      - \'4000:4000\'\n    command: |\n      bash -c "PORT=4000 node app"\n    restart: always\n    \n')])])])]),e._v(" "),n("li",[n("p",[e._v("Create a yaml file "),n("code",[e._v("k8_application.yaml.template")]),e._v(" and keep it at your project's root folder.\nThe file needs to keep the following points in account:-")]),e._v(" "),n("ul",[n("li",[e._v("The image name for containers needs to adhere to the guideline outlined in the step above.")]),e._v(" "),n("li",[e._v("Define an "),n("code",[e._v("imagePullSecrets")]),e._v(" named container-registry-cred. Creation and updation of this secret is handled by Zeeve, but the definition is developers responsibility.")]),e._v(" "),n("li",[e._v("For mounting relevant crypto data and channel artifacts in a deployment, Zeeve will create secrets and mount them on "),n("code",[e._v("/crypto-data")]),e._v(" path. The deployment/s on which this mounting takes place is identified by special character string "),n("code",[e._v("@@replace_my_crypto_artifacts@@")]),e._v(".")]),e._v(" "),n("li",[e._v("Host for each Ingress resource will be an amalgamation of information specified in .env file and domain assigned to your Kubernetes cluster.")]),e._v(" "),n("li",[e._v("Take special care to mount relevant persistent volumes as pods will be recreated whenever there is an application update.")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('apiVersion: v1\nkind: Service\nmetadata:\n  name: balance-transfer-svc\nspec:\n  type: ClusterIP\n  ports:\n    - port: 4000\n      targetPort: 4000\n      protocol: TCP\n  selector:\n    name: balance-transfer-dep\n\n ---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: balance-transfer-dep\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: balance-transfer\n  template:\n    metadata:\n      labels:\n        name: balance-transfer\n    spec:\n      volumes:\n        #- name: balance-transfer-data\n        #  persistentVolumeClaim:\n        #    claimName: balance-transfer-data-pvc\n            @@replace_my_crypto_artifacts@@\n      imagePullSecrets:\n      - name: container-registry-cred\n      containers:\n        - name: balance-transfer\n          image: balance-transfer:12\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 4000\n              protocol: TCP\n          #livenessProbe:\n          #  httpGet:\n          #    path: /\n          #    port: 4000\n          command:\n            - bash\n            - -c\n            - |\n              echo "installing GO" \n              cd /usr/local\n              curl -O https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz\n              tar -xvf go1.10.3.linux-amd64.tar.gz\n              echo "export PATH=$PATH:/usr/local/go/bin" >> /root/.bashrc\n              source /root/.bashrc\n\n              echo "configuring application"\n              mkdir /application\n              cd /application\n              cp -r /balance-transfer/* ./\n              cp -Lr /crypto-data/* ./artifacts/\n              #npm install\n              node app\n          volumeMounts:\n            #- mountPath: /application\n            #  name: balance-transfer-data\n              @@replace_my_crypto_artifacts@@\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: balance-transfer-data-pvc\nspec:\n  accessModes:\n    - "ReadWriteOnce"\n  resources:\n    requests:\n      storage: "5Gi"\n\n---\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: balance-transfer-ingress\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/backend-protocol: "http"\nspec:\n  rules:\n    - host: \n      http:\n        paths:\n        - backend:\n            serviceName: balance-transfer-svc\n            servicePort: 4000\n\n')])])])]),e._v(" "),n("li",[n("p",[e._v("While uploading the project attach some supporting documents to explain the organisation names and other details that shall be put while creating networks for the product. These documents will help users to create and deploy networks and products on their own.")])])])])}),[],!1,null,null,null);n.default=r.exports}}]);